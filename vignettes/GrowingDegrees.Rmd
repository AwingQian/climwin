---
title: "Growing degree days"
author: "Liam D. Bailey and Martijn van de Pol"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Growing degree days}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

With an introduction to the basics of the climwin package (see vignette "climwin"), we can start to explore the more advanced features. While many climate window analyses may simply use average climatic conditions, the statistic used to interpret climate data can also be more complex. Below, we introduce the parameters *upper*, *lower* and *thresh* within the `climatewin` function, and discuss their use for analysing climate windows using methods such as growing degree or chill days.

**************************

## Three new parameters

In our basic introduction we considered the main parameters needed to run the `climatewin` function. Three new parameters that we didn't discuss were upper, lower and thresh. These parameters may be useful for scenarios where we expect organisms to exhibit distinct biological thresholds. For example, plants may only grow when temperature exceeds a certain value, or organism survival may be unaffected by temperature until it falls below 0. In these situations, we want to separate out our climate data to differentiate between data that has exceeded the threshold and that which has not.

**upper/lower**

The values of upper/lower determine the location of the threshold. When a value of upper is provided in isolation `climatewin` will convert all climate data *below* this value to 0's. Similarly, when a value of lower is provided with no corresponding value of upper, `climatewin` will convert all climate data *above* this threshold to 0's. When both values are provided in conjunction, `climatewin` will instead convert all values that fall *outside* this range to 0's.

**thresh**

The values of upper and lower will dictate which climatic conditions we consider to have no effect (i.e. equal to 0), and those that we do. When thresh is TRUE, `climatewin` will produce binary climate data, where all values that exceed the set threshold are given a value of 1. In this scenario we assume that all values past our chosen threshold will have similar effects. When thresh is FALSE, the climate data past the chosen threshold are unchanged.

****************************

## How do we pick our climate threshold?

While we now have a mechanism to test the effects of thresholds in the climate data, it is important that we select the correct threshold. Similar to our climate window selection, our choice of threshold may influence the results of our analysis. Although we may often be able to select our threshold values using prior biological knowledge (e.g. thermal performance curves), in situations where we lack this detailed background knowledge it may be better to test multiple thresholds than select one arbitrarily. We provide this versatility in our `climatewin` function.

In the below example, we carry out climate window analysis using thresholds ranging from 20 to 25.

```{r, eval = FALSE}

MassWin <- climatewin(Xvar = list(Temp = MassClimate$Temp),
                      Cdate = MassClimate$Date,
                      Bdate = Mass$Date,
                      baseline = lm(Mass ~ 1, data = Mass),
                      Cinterval = "day",
                      furthest = 100, closest = 0,
                      type = "fixed", cutoff.day = 20, cutoff.month = 05,
                      stat = "mean",
                      func = "lin",
                      upper = c(20:25))
                       
```

We can view all the tested combinations in the `combos` object.

```{r, eval = FALSE}

MassWin$combos

```

|   |Climate|Type  | Stat| func| upper| Thresh|
|:--|:------|:-----|:----|:----|:-----|:------|
|1  |  Temp |fixed |mean |lin  |  20  |FALSE  |
|2  |  Temp |fixed |mean |lin  |  21  |FALSE  |
|3  |  Temp |fixed |mean |lin  |  22  |FALSE  |
|4  |  Temp |fixed |mean |lin  |  23  |FALSE  |
|5  |  Temp |fixed |mean |lin  |  24  |FALSE  |
|6  |  Temp |fixed |mean |lin  |  25  |FALSE  |

The ability to test multiple climate thresholds reduces the need for us to arbitrarily select threshold values, which in turn improves the quality of our results.

***************************

To ask additional questions, report bugs, or simply provide kind words of encouragement please e-mail:

liam.bailey@anu.edu.au
